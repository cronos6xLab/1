<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Juego del Impostor Pro</title>
    <style>
        /* ================= VARIABLES Y TEMAS ================= */
        :root {
            /* Tema base (light por defecto) */
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #111827;
            --text-muted: #6b7280;
            --input-bg: #ffffff;
            --input-border: #e5e7eb;
            --shadow-lg: 0 10px 25px -5px rgba(0,0,0,0.15);
            --modal-bg: rgba(15,23,42,0.75);

            --primary-gradient: linear-gradient(135deg, #4f46e5 0%, #8b5cf6 50%, #22c1c3 100%);
            --secondary-gradient: linear-gradient(135deg, #f97316 0%, #facc15 100%);
            --accent-pink: #ec4899;
            --accent-purple: #8b5cf6;
            --accent-cyan: #06b6d4;
            --accent-green: #22c55e;
            --accent-yellow: #facc15;

            --reveal-btn-bg: #f9fafb;
            --reveal-btn-hover: #e5e7eb;
            --reveal-btn-border: #e5e7eb;
        }

        html[data-theme="dark"] {
            --bg-color: #050816;
            --card-bg: #0b1020;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
            --input-bg: #111827;
            --input-border: #1f2937;
            --shadow-lg: 0 20px 40px rgba(0,0,0,0.75);
            --modal-bg: rgba(5, 8, 22, 0.96);

            --primary-gradient: linear-gradient(135deg, #8b5cf6 0%, #22d3ee 50%, #36d399 100%);
            --secondary-gradient: linear-gradient(135deg, #f97316 0%, #facc15 100%);
            --accent-pink: #ec4899;
            --accent-purple: #8b5cf6;
            --accent-cyan: #22d3ee;
            --accent-green: #36d399;
            --accent-yellow: #facc15;

            --reveal-btn-bg: rgba(15,23,42,0.9);
            --reveal-btn-hover: rgba(30,64,175,0.9);
            --reveal-btn-border: #1f2937;
        }

        /* ================= ESTILOS GENERALES ================= */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: radial-gradient(circle at top, #e5e7eb 0, var(--bg-color) 55%);
            color: var(--text-main);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            transition: background 0.3s ease, color 0.3s ease;
        }
        html[data-theme="dark"] body {
            background: radial-gradient(circle at top, #1d2545 0, #050816 45%, #000 100%);
        }

        .container {
            width: 100%;
            max-width: 480px;
            background: linear-gradient(145deg, rgba(255,255,255,0.97), rgba(243,244,246,0.98));
            padding: 2.5rem;
            border-radius: 1.75rem;
            box-shadow: var(--shadow-lg);
            text-align: center;
            transition: opacity 0.3s ease, transform 0.3s ease;
            position: relative;
            border: 1px solid rgba(209,213,219,0.9);
            max-height: 90vh;
            overflow-y: auto;
        }
        html[data-theme="dark"] .container {
            background: linear-gradient(145deg, rgba(15,23,42,0.97), rgba(17,24,39,0.98));
            border-color: rgba(55,65,81,0.8);
        }

        h1 {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.4rem;
            margin-bottom: 1.5rem;
            font-weight: 800;
            letter-spacing: 0.06em;
            text-shadow:
                0 0 10px rgba(139,92,246,0.35),
                0 0 18px rgba(34,211,238,0.35);
        }
        html[data-theme="dark"] h1 {
            text-shadow:
                0 0 10px rgba(139,92,246,0.8),
                0 0 18px rgba(34,211,238,0.7);
        }

        h2 { color: var(--text-main); font-weight: 700; margin-bottom: 1rem; }
        .hidden { display: none !important; }

        /* ================= INSTRUCCIONES ================= */
        .instructions-box {
            background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(34,211,238,0.1));
            border: 1px solid rgba(139,92,246,0.3);
            border-radius: 1rem;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            text-align: left;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .instructions-box h3 {
            color: var(--accent-purple);
            margin-top: 0;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instructions-box ul {
            padding-left: 1.2rem;
            margin: 0.5rem 0;
        }

        .instructions-box li {
            margin-bottom: 0.4rem;
            color: var(--text-main);
        }

        .section-help {
            font-size: 0.9rem;
            color: var(--accent-cyan);
            background: rgba(34,211,238,0.1);
            padding: 0.8rem;
            border-radius: 0.8rem;
            margin-bottom: 1.2rem;
            border-left: 3px solid var(--accent-cyan);
        }

        /* ================= BOT√ìN DARK MODE ================= */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ffffff;
            border: 2px solid #e5e7eb;
            color: #111827;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transition: transform 0.2s, box-shadow 0.2s, background 0.2s, color 0.2s, border-color 0.2s;
            z-index: 50;
        }
        html[data-theme="dark"] .theme-toggle {
            background: radial-gradient(circle at top, #111827, #020617);
            border-color: #1f2937;
            color: #f9fafb;
            box-shadow: 0 0 12px rgba(139,92,246,0.7);
        }
        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 18px rgba(34,211,238,0.5);
        }

        /* ================= FORMULARIOS ================= */
        .form-group { margin-bottom: 1.2rem; text-align: left; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-main); }
        
        .hint { font-size: 0.85rem; color: var(--text-muted); margin-top: 0.2rem; }

        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 1rem;
            background: var(--input-bg);
            color: var(--text-main);
            border: 1px solid var(--input-border);
            border-radius: 999px;
            box-sizing: border-box;
            font-size: 1.1rem;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s, background 0.3s, color 0.3s;
            box-shadow: inset 0 0 0 1px rgba(15,23,42,0.02);
        }
        input::placeholder { color: #9ca3af; }
        html[data-theme="dark"] input::placeholder { color: #6b7280; }

        input:focus {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 2px rgba(34,211,238,0.3);
        }

        /* ================= CHECKBOXES CATEGOR√çAS ================= */
        .categories-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 1rem 0;
        }

        .checkbox-item {
            position: relative;
        }

        .checkbox-item input[type="checkbox"] {
            display: none;
        }

        .checkbox-item label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.8rem;
            background: var(--input-bg);
            border: 2px solid var(--input-border);
            border-radius: 1rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            text-align: center;
            color: var(--text-main);
            margin: 0;
        }

        .checkbox-item input[type="checkbox"]:checked + label {
            border-color: var(--accent-purple);
            background: radial-gradient(circle at top, rgba(139,92,246,0.2), var(--input-bg));
            color: var(--accent-cyan);
            box-shadow: 0 0 18px rgba(139,92,246,0.4);
        }

        /* Radio Buttons Custom */
        .radio-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .radio-option {
            flex: 1;
            position: relative;
        }
        .radio-option input { opacity: 0; position: absolute; width: 0; }
        .radio-option label {
            display: block;
            padding: 0.8rem;
            background: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            text-align: center;
            color: var(--text-main);
        }
        .radio-option input:checked + label {
            border-color: var(--accent-purple);
            background: radial-gradient(circle at top, rgba(139,92,246,0.15), var(--input-bg));
            color: var(--accent-cyan);
            box-shadow: 0 0 18px rgba(139,92,246,0.35);
        }

        /* ================= √ÅREA DE TEXTO PERSONALIZADO ================= */
        .custom-words-container {
            margin-top: 1rem;
            padding: 1.2rem;
            border-radius: 1.25rem;
            border: 2px dashed var(--accent-purple);
            background: rgba(139,92,246,0.05);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            background: var(--input-bg);
            color: var(--text-main);
            border: 1px solid var(--input-border);
            border-radius: 1rem;
            box-sizing: border-box;
            font-size: 1rem;
            font-family: inherit;
            outline: none;
            resize: vertical;
            transition: border-color 0.3s, box-shadow 0.3s;
            line-height: 1.4;
        }

        textarea:focus {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 2px rgba(34,211,238,0.3);
        }

        textarea::placeholder {
            color: var(--text-muted);
        }

        .custom-info {
            font-size: 0.85rem;
            color: var(--accent-cyan);
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* ================= BOTONES ================= */
        button.main-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s, filter 0.2s;
            width: 100%;
            margin-top: 1rem;
            box-shadow:
                0 0 20px rgba(34,211,238,0.35),
                0 0 40px rgba(139,92,246,0.35);
        }
        button.main-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            filter: brightness(1.05);
        }
        button.main-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; box-shadow: none; }
        
        button.secondary-btn {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            box-shadow: none;
            margin-top: 10px;
        }
        html[data-theme="dark"] button.secondary-btn {
            background: linear-gradient(135deg, #374151, #111827);
        }
        button.accent-btn { background: var(--secondary-gradient); color: #111827; }

        /* ================= LISTA JUGADORES ================= */
        .player-list {
            max-height: 260px;
            overflow-y: auto;
            margin: 1.5rem 0 0.7rem;
            padding: 0.2rem;
        }
        .player-input-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
            background: var(--reveal-btn-bg);
            padding: 0.5rem 0.8rem;
            border-radius: 999px;
            border: 1px solid var(--reveal-btn-border);
        }
        .player-input-item span {
            color: var(--accent-cyan);
        }

        .reveal-btn {
            background: var(--reveal-btn-bg);
            color: var(--text-main);
            border: 1px solid var(--reveal-btn-border);
            padding: 1rem;
            border-radius: 1rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }
        .reveal-btn:hover:not(:disabled) {
            border-color: var(--accent-cyan);
            background: var(--reveal-btn-hover);
            box-shadow: 0 0 20px rgba(34,211,238,0.25);
        }
        .reveal-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            text-decoration: line-through;
            box-shadow: none;
        }

        /* ================= RULETA ================= */
        .roulette-container {
            margin-top: 1.2rem;
            padding: 1.2rem;
            border-radius: 1.25rem;
            border: 1px dashed var(--input-border);
            background: rgba(249,250,251,0.9);
        }
        html[data-theme="dark"] .roulette-container {
            background: rgba(15,23,42,0.85);
        }

        .roulette-wheel {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            margin: 0 auto 0.8rem;
            border: 4px solid rgba(148,163,184,0.9);
            position: relative;
            overflow: hidden;
            box-shadow:
                0 0 18px rgba(139,92,246,0.45),
                0 0 28px rgba(34,211,238,0.35);
            transition: transform 3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .roulette-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            top: 50%;
            left: 50%;
            transform-origin: 0% 0%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 0.7rem;
            text-align: center;
            padding: 0.2rem;
        }
        .roulette-pointer {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 16px solid #facc15;
            margin: 0 auto 0.4rem;
        }
        .roulette-winner {
            margin-top: 0.4rem;
            font-size: 0.95rem;
            color: var(--accent-yellow);
            font-weight: 700;
        }

        /* ================= MODAL & CARDS ================= */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: var(--modal-bg);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 20px;
        }
        .modal {
            background: radial-gradient(circle at top, #ffffff, #e5e7eb);
            padding: 2.5rem;
            border-radius: 2rem;
            width: 100%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
            animation: popUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            color: var(--text-main);
            border: 1px solid rgba(209,213,219,0.9);
        }
        html[data-theme="dark"] .modal {
            background: radial-gradient(circle at top, #111827, #020617);
            border-color: rgba(55,65,81,0.9);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.7);
        }
        @keyframes popUp {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .role-card {
            padding: 2rem;
            border-radius: 1.5rem;
            margin-bottom: 2rem;
            color: white;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }
        .role-card::before {
            content: "";
            position: absolute;
            inset: -40%;
            background: conic-gradient(from 180deg, rgba(139,92,246,0.6), rgba(34,211,238,0.4), rgba(249,115,22,0.7), rgba(236,72,153,0.8), rgba(34,211,238,0.4));
            opacity: 0.25;
            mix-blend-mode: screen;
        }
        .role-card > * { position: relative; z-index: 1; }

        .impostor-card {
            background: radial-gradient(circle at top, #f97316 0, #e11d48 40%, #4c0519 100%);
            box-shadow: 0 0 25px rgba(248,113,113,0.6);
        }

        .civil-card {
            background: radial-gradient(circle at top, #22c55e 0, #22d3ee 40%, #022c22 100%);
            box-shadow: 0 0 25px rgba(34,211,238,0.6);
        }

        .word-box {
            background: rgba(15,23,42,0.05);
            font-size: 2.2rem;
            font-weight: 800;
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 1rem;
            border: 1px solid rgba(148,163,184,0.6);
            text-shadow: 0 0 6px rgba(34,211,238,0.55);
        }
        html[data-theme="dark"] .word-box {
            background: rgba(15,23,42,0.5);
        }
        
        /* ================= TIMER & GAME SCREEN ================= */
        .timer-display {
            font-size: 4rem;
            font-weight: 800;
            font-variant-numeric: tabular-nums;
            margin: 2rem 0;
            color: var(--accent-cyan);
            text-shadow:
                0 0 12px rgba(34,211,238,0.5),
                0 0 22px rgba(139,92,246,0.35);
        }
        html[data-theme="dark"] .timer-display {
            text-shadow:
                0 0 12px rgba(34,211,238,0.9),
                0 0 22px rgba(139,92,246,0.7);
        }
        .timer-finished {
            color: #f97316;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .rounds-display {
            font-size: 1.5rem;
            margin: 2rem 0;
            padding: 2rem;
            border: 2px dashed var(--input-border);
            border-radius: 1rem;
            background: rgba(249,250,251,0.9);
        }
        html[data-theme="dark"] .rounds-display {
            background: rgba(15,23,42,0.8);
        }

        .back-menu-btn {
            margin-top: 0.75rem;
            background: linear-gradient(135deg, #ef4444, #b91c1c);
        }

        .selected-categories {
            margin-top: 0.8rem;
            padding: 0.8rem;
            background: rgba(249,250,251,0.9);
            border-radius: 1rem;
            border: 1px dashed var(--input-border);
            font-size: 0.9rem;
            color: var(--text-main);
        }
        html[data-theme="dark"] .selected-categories {
            background: rgba(15,23,42,0.85);
            border-color: #1f2937;
        }
    </style>
</head>
<body>

    <button class="theme-toggle" onclick="toggleTheme()" id="theme-btn" title="Cambiar tema">üåô</button>

    <div class="container" id="setup-screen">
        <h1>üïµÔ∏è‚Äç‚ôÇÔ∏è El Impostor</h1>
        
        <div class="instructions-box">
            <h3>üìö ¬øC√≥mo jugar?</h3>
            <p>En este juego, hay <strong>civiles</strong> que conocen una palabra secreta y <strong>impostores</strong> que no la conocen.</p>
            <ul>
                <li>Los civiles deben dar pistas sobre la palabra sin revelarla directamente</li>
                <li>Los impostores deben fingir que conocen la palabra</li>
                <li>Al final, todos votan para descubrir qui√©n es el impostor</li>
            </ul>
        </div>
        
        <div class="form-group">
            <label>üë• Configuraci√≥n Jugadores</label>
            <div class="section-help">
                üí° Recomendaci√≥n: 4-8 jugadores. Al menos 1 impostor por cada 4 jugadores funciona mejor.
            </div>
            <div style="display: flex; gap: 10px;">
                <div style="flex:1;">
                    <span class="hint">Total de jugadores</span>
                    <input type="number" id="num-players" value="4" min="3" max="20" placeholder="Total">
                </div>
                <div style="flex:1;">
                    <span class="hint">Cantidad de impostores</span>
                    <input type="number" id="num-impostors" value="1" min="1" max="19" placeholder="Impostores">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>‚è±Ô∏è Modo de Juego</label>
            <div class="section-help">
                ‚è∞ Elige si quieres jugar con tiempo limitado o con un n√∫mero fijo de rondas.
            </div>
            <div class="radio-group">
                <div class="radio-option">
                    <input type="radio" id="mode-timer" name="gameMode" value="timer" checked onchange="toggleModeInputs()">
                    <label for="mode-timer">Temporizador</label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="mode-rounds" name="gameMode" value="rounds" onchange="toggleModeInputs()">
                    <label for="mode-rounds">Rondas</label>
                </div>
            </div>

            <div id="input-timer-container">
                <span class="hint">Duraci√≥n del debate (minutos)</span>
                <input type="number" id="game-minutes" value="5" min="1" max="60">
            </div>

            <div id="input-rounds-container" class="hidden">
                <span class="hint">Cantidad de preguntas/rondas</span>
                <input type="number" id="game-rounds" value="2" min="1" max="10">
            </div>
        </div>

        <button class="main-btn" onclick="setupPlayers()">Continuar üëâ</button>
    </div>

    <div class="container hidden" id="categories-screen">
        <h2>üé¨ Selecciona Categor√≠as</h2>
        <div class="section-help">
            üéØ Selecciona una o varias categor√≠as. La palabra secreta ser√° elegida aleatoriamente de las categor√≠as seleccionadas.
        </div>

        <div class="categories-grid">
            <div class="checkbox-item">
                <input type="checkbox" id="cat-lugares" onchange="updateSelectedCategories()">
                <label for="cat-lugares">üèñÔ∏è Lugares</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-objetos" onchange="updateSelectedCategories()">
                <label for="cat-objetos">üì± Objetos</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-comidas" onchange="updateSelectedCategories()">
                <label for="cat-comidas">üçï Comidas</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-animales" onchange="updateSelectedCategories()">
                <label for="cat-animales">üê∂ Animales</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-profesiones" onchange="updateSelectedCategories()">
                <label for="cat-profesiones">üë®‚Äç‚öïÔ∏è Profesiones</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-transporte" onchange="updateSelectedCategories()">
                <label for="cat-transporte">üöó Transporte</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-instrumentos" onchange="updateSelectedCategories()">
                <label for="cat-instrumentos">üé∏ Instrumentos</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-hogar" onchange="updateSelectedCategories()">
                <label for="cat-hogar">üè† Hogar</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-peliculas" onchange="updateSelectedCategories()">
                <label for="cat-peliculas">üé¨ Pel√≠culas</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-anime" onchange="updateSelectedCategories()">
                <label for="cat-anime">üéå Anime</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-bandas" onchange="updateSelectedCategories()">
                <label for="cat-bandas">üéµ Bandas</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-disney" onchange="updateSelectedCategories()">
                <label for="cat-disney">‚ú® Disney</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-deportes" onchange="updateSelectedCategories()">
                <label for="cat-deportes">‚öΩ Deportes</label>
            </div>
            <div class="checkbox-item">
                <input type="checkbox" id="cat-personalizado" onchange="toggleCustomWords()">
                <label for="cat-personalizado">üé® Personalizado</label>
            </div>
        </div>

        <!-- Contenedor para palabras personalizadas -->
        <div id="custom-words-container" class="custom-words-container hidden">
            <div class="section-help">
                ‚úèÔ∏è Escribe tus propias palabras separadas por comas. Estas se agregar√°n como una categor√≠a adicional.
            </div>
            <textarea 
                id="custom-words-input" 
                placeholder="Ejemplo: Pizza, Cine, Futbol, Guitarra, Playa, Netflix, Caf√©, Monta√±a"
                oninput="updateCustomWords()"
            ></textarea>
            <p class="custom-info">M√≠nimo 3 palabras recomendado. Cuantas m√°s palabras, m√°s variado ser√° el juego.</p>
        </div>

        <div class="selected-categories">
            <strong>Categor√≠as seleccionadas:</strong> <span id="selected-count">0</span>
        </div>

        <button class="main-btn" onclick="proceedWithCategories()">Siguiente ‚úì</button>
        <button class="main-btn secondary-btn back-menu-btn" onclick="goToMainMenu()">üè† Volver al men√∫ principal</button>
    </div>

    <div class="container hidden" id="names-screen">
        <h2>üè∑Ô∏è Nombres de los Jugadores</h2>
        <div class="section-help">
            üë§ Escribe el nombre de cada jugador. Puedes usar nombres reales o apodos. 
            Los nombres se usar√°n durante todo el juego.
        </div>
        <div id="player-inputs" class="player-list"></div>

        <button class="main-btn" onclick="assignRoles()">üé≤ Asignar Roles</button>
        <button class="main-btn secondary-btn back-menu-btn" onclick="goToMainMenu()">üè† Volver al men√∫ principal</button>
    </div>

    <div class="container hidden" id="reveal-screen">
        <h2>ü§´ Revelaci√≥n de Roles</h2>
        <div class="section-help">
            üîí Pasa el dispositivo a cada jugador <strong>uno por uno</strong>. 
            Cada jugador debe presionar su bot√≥n para ver su rol en <strong>secreto</strong>.
            No dejes que los dem√°s vean tu pantalla.
        </div>
        
        <div id="reveal-buttons" class="player-list"></div>

        <!-- RULETA DESPU√âS DE REPARTIR ROLES -->
        <div class="roulette-container">
            <div class="section-help">
                üé° Despu√©s de que todos vean sus roles, gira la ruleta para elegir qui√©n empieza el debate.
            </div>
            <div class="roulette-pointer"></div>
            <div class="roulette-wheel" id="roulette-wheel"></div>
            <button class="main-btn accent-btn" style="margin-top:0.3rem;" onclick="spinRoulette()">üé° Girar para elegir qui√©n empieza</button>
            <div class="roulette-winner" id="roulette-winner"></div>
        </div>
        
        <button id="btn-start-debate" class="main-btn accent-btn hidden" onclick="startDebate()">üî• Comenzar Debate</button>
        <button class="main-btn secondary-btn back-menu-btn" onclick="goToMainMenu()">üè† Volver al men√∫ principal</button>
    </div>

    <div class="container hidden" id="active-game-screen">
        <h2 id="active-mode-title">üí¨ Fase de Debate</h2>
        
        <div id="active-content"></div>

        <div class="instructions-box">
            <h3>üéÆ Instrucciones del Debate</h3>
            <p><strong>Para los CIVILES:</strong></p>
            <ul>
                <li>Da pistas sobre la palabra sin decirla directamente</li>
                <li>Escucha atentamente a los dem√°s para detectar al impostor</li>
                <li>Pregunta a otros jugadores sobre la palabra</li>
            </ul>
            <p><strong>Para el IMPOSTOR:</strong></p>
            <ul>
                <li>Finge que conoces la palabra</li>
                <li>Da pistas vagas o copia el estilo de los civiles</li>
                <li>No te pongas nervioso cuando te pregunten</li>
            </ul>
            <p><strong>Al final del tiempo/rondas:</strong> Voten qui√©n creen que es el impostor.</p>
        </div>

        <button class="main-btn secondary-btn" onclick="restartGame()">üîÑ Nuevo Juego</button>
        <button class="main-btn secondary-btn back-menu-btn" onclick="goToMainMenu()">üè† Volver al men√∫ principal</button>
    </div>

    <div id="modal-overlay" class="modal-overlay hidden">
        <div class="modal">
            <div id="modal-content"></div>
            <button class="main-btn" onclick="closeModal()">Entendido, cerrar üîí</button>
        </div>
    </div>

    <!-- Elemento de audio para la alarma -->
    <audio id="alarm-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>

    <script>
        // ================= DATOS =================
        const diccionario = {
            "Lugares": ["Playa", "Escuela", "Hospital", "Aeropuerto", "Cine", "Supermercado", "Gimnasio", "Hotel", "Restaurante", "Parque", "Museo", "Iglesia", "Cementerio", "Zoologico", "Circo"],
            "Objetos": ["Celular", "Llaves", "Mochila", "Sill√≥n", "Zapatillas", "Reloj", "Auriculares", "L√°mpara", "Computadora", "Bicicleta", "Paraguas", "Espejo", "Cama", "Cepillo de dientes", "Papel Higi√©nico"],
            "Comidas": ["Pizza", "Empanadas", "Asado", "Sushi", "Hamburguesa", "Helado", "Ensalada", "Pan", "Tacos", "Pasta", "Pollo", "Chocolate", "Huevo frito", "Papas fritas", "Sopa"],
            "Animales": ["Perro", "Gato", "Caballo", "Elefante", "Tibur√≥n", "Le√≥n", "Ping√ºino", "Mono", "Delf√≠n", "Conejo", "Jirafa", "Ara√±a", "Mariposa", "Tortuga", "Cocodrilo", "Serpiente"],
            "Profesiones": ["M√©dico", "Maestro", "Abogado", "Arquitecto", "Programador", "Cocinero", "Actor", "Piloto", "Bombero", "Polic√≠a", "Cantante", "Cient√≠fico", "Astronauta", "Mec√°nico", "Payaso"],
            "Transporte": ["Colectivo/Bus", "Tren", "Avi√≥n", "Auto", "Moto", "Bicicleta", "Barco", "Submarino", "Helic√≥ptero", "Cami√≥n", "Metro", "Monopat√≠n", "Taxi", "Globo Aerost√°tico", "Caballo"],
            "Instrumentos": ["Guitarra", "Piano", "Bater√≠a", "Viol√≠n", "Flauta", "Trompeta", "Saxof√≥n", "Ukelele", "Acorde√≥n", "Arpa", "Maracas", "Tri√°ngulo", "Bajo", "Arm√≥nica"],
            "Hogar": ["Cocina", "Ba√±o", "Dormitorio", "S√≥tano", "√Åtico", "Jard√≠n", "Garaje", "Balc√≥n", "Techo", "Pasillo", "Comedor", "Sala de estar"],
            "Peliculas": ["Titanic", "Avatar", "The Godfather", "Star Wars", "The Avengers", "Jurassic Park", "The Dark Knight", "Inception", "Forrest Gump", "Pulp Fiction", "The Matrix", "Gladiator", "The Shawshank Redemption", "Schindler's List", "Lord of the Rings", "Harry Potter", "Spider-Man", "Batman", "Superman", "Iron Man"],
            "Anime": ["Naruto", "One Piece", "Dragon Ball", "Attack on Titan", "Death Note", "Bleach", "My Hero Academia", "Demon Slayer", "Fullmetal Alchemist", "Hunter x Hunter", "Sword Art Online", "Tokyo Ghoul", "Cowboy Bebop", "Neon Genesis Evangelion", "Code Geass", "Steins Gate", "One Punch Man", "Mob Psycho 100", "Jujutsu Kaisen", "Chainsaw Man"],
            "Bandas": ["The Beatles", "Queen", "Led Zeppelin", "Pink Floyd", "The Rolling Stones", "Nirvana", "Metallica", "AC/DC", "Guns N' Roses", "U2", "Coldplay", "Radiohead", "The Doors", "The Who", "Aerosmith", "Kiss", "Bon Jovi", "Def Leppard", "Journey", "Foreigner"],
            "Disney": ["Mickey Mouse", "Minnie Mouse", "Donald Duck", "Frozen", "Elsa", "Anna", "Olaf", "Moana", "Maui", "Aladdin", "Jasmine", "Genie", "Beauty and the Beast", "Belle", "Beast", "The Little Mermaid", "Ariel", "Cinderella", "Snow White", "Sleeping Beauty"],
            "Deportes": ["F√∫tbol", "B√°squetbol", "Tenis", "Nataci√≥n", "Atletismo", "Ciclismo", "Boxeo", "Golf", "Voleibol", "Rugby", "B√©isbol", "Hockey", "Ski", "Snowboard", "Surf"]
        };

        // Estado del juego
        let players = [];
        let secretWord = "";
        let secretCategory = "";
        let currentImpostors = [];
        let currentPlayerViewing = null;
        let rolesSeenCount = 0;
        let gameConfig = { mode: 'timer', value: 5 };
        let timerInterval = null;
        let selectedCategories = [];
        let customWords = [];

        // ================= MODO D√çA / NOCHE =================
        function toggleTheme() {
            const html = document.documentElement;
            const btn = document.getElementById('theme-btn');
            const current = html.getAttribute('data-theme') || 'light';
            const next = current === 'light' ? 'dark' : 'light';

            html.setAttribute('data-theme', next);
            btn.innerText = next === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        // ================= INPUTS SETUP =================
        function toggleModeInputs() {
            const isTimer = document.getElementById('mode-timer').checked;
            if (isTimer) {
                document.getElementById('input-timer-container').classList.remove('hidden');
                document.getElementById('input-rounds-container').classList.add('hidden');
            } else {
                document.getElementById('input-timer-container').classList.add('hidden');
                document.getElementById('input-rounds-container').classList.remove('hidden');
            }
        }

        // ================= CATEGOR√çA PERSONALIZADA =================
        function toggleCustomWords() {
            const customCheckbox = document.getElementById('cat-personalizado');
            const customContainer = document.getElementById('custom-words-container');
            
            if (customCheckbox.checked) {
                customContainer.classList.remove('hidden');
                updateSelectedCategories();
            } else {
                customContainer.classList.add('hidden');
                document.getElementById('custom-words-input').value = "";
                customWords = [];
                updateSelectedCategories();
            }
        }

        function updateCustomWords() {
            const textarea = document.getElementById('custom-words-input');
            const wordsText = textarea.value.trim();
            
            if (wordsText) {
                // Separar por comas, limpiar espacios y filtrar elementos vac√≠os
                customWords = wordsText.split(',')
                    .map(word => word.trim())
                    .filter(word => word.length > 0);
            } else {
                customWords = [];
            }
        }

        // ================= PASO 1: SETUP N√öMEROS =================
        function setupPlayers() {
            const num = parseInt(document.getElementById('num-players').value);
            const imps = parseInt(document.getElementById('num-impostors').value);
            
            const isTimer = document.getElementById('mode-timer').checked;
            gameConfig.mode = isTimer ? 'timer' : 'rounds';
            gameConfig.value = parseInt(document.getElementById(isTimer ? 'game-minutes' : 'game-rounds').value);

            if (isNaN(num) || isNaN(imps) || num < 3 || imps < 1 || imps >= num) {
                alert("‚ö†Ô∏è Error en configuraci√≥n:\n- M√≠nimo 3 jugadores.\n- Debe haber al menos 1 impostor y al menos 2 civiles.\n- Los impostores deben ser menos que el total de jugadores.");
                return;
            }

            // Resetear checkboxes y mostrar pantalla de categor√≠as
            document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => cb.checked = false);
            selectedCategories = [];
            customWords = [];
            document.getElementById('custom-words-input').value = "";
            document.getElementById('custom-words-container').classList.add('hidden');
            updateSelectedCategories();

            transitionToScreen('setup-screen', 'categories-screen');
        }

        // ================= CATEGOR√çAS =================
        function updateSelectedCategories() {
            const checkboxes = document.querySelectorAll('.checkbox-item input[type="checkbox"]:checked');
            selectedCategories = [];
            checkboxes.forEach(cb => {
                const catName = cb.id.replace('cat-', '').charAt(0).toUpperCase() + cb.id.replace('cat-', '').slice(1);
                selectedCategories.push(catName);
            });
            document.getElementById('selected-count').textContent = selectedCategories.length;
        }

        function proceedWithCategories() {
            if (selectedCategories.length === 0) {
                alert("‚ö†Ô∏è Por favor, selecciona al menos una categor√≠a.");
                return;
            }

            // Verificar si se seleccion√≥ personalizado pero no se ingresaron palabras
            const customCheckbox = document.getElementById('cat-personalizado');
            if (customCheckbox.checked && customWords.length === 0) {
                alert("‚ö†Ô∏è Has seleccionado 'Personalizado' pero no has ingresado palabras.\n\nPor favor, escribe algunas palabras separadas por comas o deselecciona la categor√≠a personalizada.");
                return;
            }

            // Mostrar pantalla de nombres
            const num = parseInt(document.getElementById('num-players').value);
            const container = document.getElementById('player-inputs');
            container.innerHTML = "";
            players = [];

            for (let i = 1; i <= num; i++) {
                const id = `pname-${i-1}`;
                players.push(`Jugador ${i}`);

                container.innerHTML += `
                    <div class="player-input-item">
                        <span style="font-weight:bold; min-width:20px;">${i}.</span>
                        <input type="text" value="Jugador ${i}" id="${id}" placeholder="Nombre del jugador" oninput="handleNameChange(${i-1})">
                    </div>`;
            }

            updateRoulette();
            transitionToScreen('categories-screen', 'names-screen');
        }

        // Mantener nombres sincronizados en el array players
        function handleNameChange(index) {
            const input = document.getElementById(`pname-${index}`);
            const value = (input.value || "").trim();
            players[index] = value || `Jugador ${index + 1}`;
            updateRoulette();
        }

        // ================= RULETA DE JUGADORES =================
        const rouletteColors = ['#8b5cf6', '#22d3ee', '#36d399', '#f97316', '#ec4899', '#0ea5e9'];
        let rouletteSpinning = false;

        function updateRoulette() {
            const wheel = document.getElementById('roulette-wheel');
            if (!wheel) return;

            wheel.innerHTML = "";

            const activePlayers = players.filter(name => name && name.trim().length > 0);
            const count = activePlayers.length;
            if (count === 0) return;

            const angleStep = 360 / count;

            activePlayers.forEach((name, index) => {
                const segment = document.createElement('div');
                segment.className = 'roulette-segment';
                segment.style.transform = `rotate(${angleStep * index}deg) skewY(${90 - angleStep}deg)`;
                segment.style.background = rouletteColors[index % rouletteColors.length];
                segment.innerHTML = `<span style="transform: skewY(${-(90 - angleStep)}deg) rotate(${-angleStep/2}deg); display:block; width:100%; padding:0 4px;">${name}</span>`;
                wheel.appendChild(segment);
            });
        }

        function spinRoulette() {
            if (rouletteSpinning) return;

            const activePlayers = players.filter(name => name && name.trim().length > 0);
            if (activePlayers.length === 0) {
                alert("Primero ingresa al menos un nombre.");
                return;
            }

            rouletteSpinning = true;
            const wheel = document.getElementById('roulette-wheel');
            const winnerLabel = document.getElementById('roulette-winner');

            const winnerIndex = Math.floor(Math.random() * activePlayers.length);
            const anglePerSegment = 360 / activePlayers.length;
            const targetAngle = 360 * 5 + (360 - (winnerIndex * anglePerSegment + anglePerSegment / 2));

            wheel.style.transform = `rotate(${targetAngle}deg)`;

            setTimeout(() => {
                rouletteSpinning = false;
                wheel.style.transform = `rotate(${(360 - (winnerIndex * anglePerSegment + anglePerSegment / 2)) % 360}deg)`;
                wheel.style.transition = "none";
                
                setTimeout(() => {
                    wheel.style.transition = "transform 3s cubic-bezier(0.16, 1, 0.3, 1)";
                }, 50);
                
                winnerLabel.textContent = `¬°${activePlayers[winnerIndex]} empieza el debate! üé§`;
            }, 3000);
        }

        // ================= PASO 2: ASIGNAR ROLES =================
        function assignRoles() {
            const numInputs = document.querySelectorAll('[id^="pname-"]').length;
            players = [];
            for (let i = 0; i < numInputs; i++) {
                const nameInput = document.getElementById(`pname-${i}`).value.trim();
                players.push(nameInput || `Jugador ${i+1}`);
            }
            updateRoulette();

            // Crear diccionario temporal que incluya las categor√≠as seleccionadas
            const tempDictionary = {};
            
            // Agregar categor√≠as seleccionadas del diccionario original
            selectedCategories.forEach(category => {
                if (category !== "Personalizado" && diccionario[category]) {
                    tempDictionary[category] = diccionario[category];
                }
            });

            // Agregar categor√≠a personalizada si est√° seleccionada
            const customCheckbox = document.getElementById('cat-personalizado');
            if (customCheckbox.checked && customWords.length > 0) {
                tempDictionary["Personalizado"] = customWords;
            }

            // Verificar que haya al menos una categor√≠a con palabras
            const availableCategories = Object.keys(tempDictionary);
            if (availableCategories.length === 0) {
                alert("Error: No hay categor√≠as v√°lidas con palabras disponibles.");
                return;
            }

            // Elegir categor√≠a aleatoria del diccionario temporal
            const randomCategory = availableCategories[Math.floor(Math.random() * availableCategories.length)];
            secretCategory = randomCategory;
            const palabras = tempDictionary[secretCategory] || [];
            secretWord = palabras.length > 0 ? palabras[Math.floor(Math.random() * palabras.length)] : "Palabra";
            
            const numImps = parseInt(document.getElementById('num-impostors').value);
            currentImpostors = [];
            while(currentImpostors.length < numImps) {
                let r = Math.floor(Math.random() * players.length);
                if(!currentImpostors.includes(r)) currentImpostors.push(r);
            }

            rolesSeenCount = 0;
            const revealContainer = document.getElementById('reveal-buttons');
            revealContainer.innerHTML = "";
            players.forEach((name, index) => {
                revealContainer.innerHTML += `
                    <button class="reveal-btn" id="btn-reveal-${index}" onclick="showRole(${index})">
                        <span>üë§ <strong>${name}</strong> - Ver rol secreto</span>
                        <span>üëÅÔ∏è Ver</span>
                    </button>`;
            });
            
            document.getElementById('btn-start-debate').classList.add('hidden');
            transitionToScreen('names-screen', 'reveal-screen');
        }

        // ================= PASO 3: MOSTRAR ROLES =================
        function showRole(index) {
            const btn = document.getElementById(`btn-reveal-${index}`);
            if (btn.disabled) return;

            currentPlayerViewing = index;
            const modal = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            const isImpostor = currentImpostors.includes(index);
            const playerName = players[index];

            let htmlContent = "";
            
            if(isImpostor) {
                htmlContent = `
                    <div class="role-card impostor-card">
                        <h2>üòà ¬°ERES EL IMPOSTOR!</h2>
                        <div class="word-box">???</div>
                        <p><strong>Instrucciones:</strong></p>
                        <ul style="text-align:left; font-size:0.9rem">
                            <li>No sabes la palabra secreta</li>
                            <li>Finge que conoces la palabra</li>
                            <li>Da pistas vagas y observa a los civiles</li>
                            <li>No te pongas nervioso cuando te pregunten</li>
                        </ul>
                    </div>`;
            } else {
                htmlContent = `
                    <div class="role-card civil-card">
                        <h2>üòá ¬°ERES CIVIL!</h2>
                        <p><strong>Categor√≠a:</strong> ${secretCategory}</p>
                        <div class="word-box">${secretWord}</div>
                        <p><strong>Instrucciones:</strong></p>
                        <ul style="text-align:left; font-size:0.9rem">
                            <li>Conoces la palabra secreta</li>
                            <li>Da pistas sutiles sin revelarla</li>
                            <li>Observa qui√©n podr√≠a ser el impostor</li>
                            <li>Pregunta a otros jugadores sobre la palabra</li>
                        </ul>
                    </div>`;
            }
            htmlContent += `<p><strong>${playerName}</strong>, memoriza tu rol y cierra esta ventana.</p>`;
            
            content.innerHTML = htmlContent;
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.add('hidden');
            if (currentPlayerViewing !== null) {
                const btn = document.getElementById(`btn-reveal-${currentPlayerViewing}`);
                btn.disabled = true;
                btn.innerHTML = `<span>üë§ ${players[currentPlayerViewing]}</span> <span>‚úÖ Listo</span>`;
                currentPlayerViewing = null;
                rolesSeenCount++;

                if(rolesSeenCount >= players.length) {
                    document.getElementById('btn-start-debate').classList.remove('hidden');
                }
            }
        }

        // ================= PASO 4: FASE DEBATE =================
        function startDebate() {
            transitionToScreen('reveal-screen', 'active-game-screen');
            const content = document.getElementById('active-content');
            
            if (gameConfig.mode === 'timer') {
                document.getElementById('active-mode-title').innerText = "‚è±Ô∏è Debate - Tiempo Restante";
                content.innerHTML = `<div class="section-help">
                    ‚è∞ Tienes ${gameConfig.value} minutos para debatir. Cuando el tiempo termine, voten qui√©n es el impostor.
                </div>
                <div id="timer-val" class="timer-display">00:00</div>
                <button class="main-btn" id="timer-control" onclick="toggleTimer()">‚è∏Ô∏è Pausar</button>`;
                startTimer(gameConfig.value * 60);
            } else {
                document.getElementById('active-mode-title').innerText = "üó£Ô∏è Debate - Rondas de Preguntas";
                content.innerHTML = `
                    <div class="section-help">
                    üîÑ Jueguen ${gameConfig.value} rondas completas. En cada ronda, cada jugador debe hacer una pregunta o dar una pista.
                    </div>
                    <div class="rounds-display">
                        <p><strong>Rondas a jugar:</strong> ${gameConfig.value}</p>
                        <p style="font-size:0.9rem; color:var(--text-muted)">Empieza el jugador que sali√≥ en la ruleta o elijan al azar.</p>
                        <p style="font-size:0.9rem; color:var(--accent-cyan)">üí° Sugerencia: Lleven la cuenta de las rondas en papel o mentalmente.</p>
                    </div>`;
            }
        }

        // ================= TEMPORIZADOR =================
        let timeRemaining = 0;
        let isPaused = false;

        // Crear y configurar el sonido de alarma
        function createAlarmSound() {
            try {
                // Crear contexto de audio
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Configurar el sonido de alarma
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
                
                // Reproducir durante 3 segundos
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 3);
                
                // Limpiar recursos
                setTimeout(() => {
                    oscillator.disconnect();
                    gainNode.disconnect();
                }, 3000);
            } catch (e) {
                console.log("No se pudo crear el sonido de alarma:", e);
                // Fallback: intentar reproducir un sonido de audio est√°ndar
                const audioElement = document.getElementById('alarm-sound');
                if (audioElement) {
                    audioElement.currentTime = 0;
                    audioElement.play().catch(e => console.log("Error reproduciendo audio:", e));
                }
            }
        }

        function startTimer(seconds) {
            timeRemaining = seconds;
            updateTimerDisplay();
            isPaused = false;
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                if(!isPaused) {
                    timeRemaining--;
                    updateTimerDisplay();
                    if(timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        document.getElementById('timer-val').classList.add('timer-finished');
                        document.getElementById('timer-val').innerText = "00:00";

                        // Reproducir sonido de alarma
                        createAlarmSound();

                        // Vibrar el dispositivo
                        if ("vibrate" in navigator) {
                            navigator.vibrate([300, 150, 300, 150, 300]);
                        }

                        // Mostrar alerta visual
                        setTimeout(() => {
                            alert("‚è∞ ¬°Tiempo terminado! ¬°Es hora de votar!\n\nDiscutan r√°pidamente y voten qui√©n creen que es el impostor.");
                        }, 500);
                    }
                }
            }, 1000);
        }

        function toggleTimer() {
            isPaused = !isPaused;
            const btn = document.getElementById('timer-control');
            btn.innerText = isPaused ? "‚ñ∂Ô∏è Reanudar" : "‚è∏Ô∏è Pausar";
            btn.style.background = isPaused ? "var(--secondary-gradient)" : "var(--primary-gradient)";
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeRemaining / 60);
            const s = timeRemaining % 60;
            document.getElementById('timer-val').innerText = 
                `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        // ================= UTILIDADES =================
        function restartGame() {
            if (confirm("¬øReiniciar juego con los mismos jugadores?")) {
                if (timerInterval) clearInterval(timerInterval);

                document.getElementById('active-game-screen').classList.add('hidden');
                document.getElementById('reveal-screen').classList.remove('hidden');

                currentImpostors = [];
                secretWord = "";
                secretCategory = "";
                rolesSeenCount = 0;

                document.getElementById('reveal-buttons').innerHTML = "";
                document.getElementById('roulette-winner').textContent = "";
                document.getElementById('btn-start-debate').classList.add('hidden');
                
                assignRoles();
            }
        }

        function goToMainMenu() {
            if (timerInterval) clearInterval(timerInterval);
            
            if (!confirm("¬øVolver al men√∫ principal? Se perder√° el progreso actual.")) {
                return;
            }

            document.getElementById('names-screen').classList.add('hidden');
            document.getElementById('reveal-screen').classList.add('hidden');
            document.getElementById('active-game-screen').classList.add('hidden');
            document.getElementById('categories-screen').classList.add('hidden');

            currentImpostors = [];
            secretWord = "";
            secretCategory = "";
            rolesSeenCount = 0;
            selectedCategories = [];
            customWords = [];

            document.getElementById('reveal-buttons').innerHTML = "";
            document.getElementById('roulette-winner').textContent = "";
            document.getElementById('btn-start-debate').classList.add('hidden');
            document.getElementById('custom-words-input').value = "";
            document.getElementById('custom-words-container').classList.add('hidden');

            document.getElementById('setup-screen').classList.remove('hidden');
        }

        function transitionToScreen(fromId, toId) {
            const fromEl = document.getElementById(fromId);
            const toEl = document.getElementById(toId);
            
            fromEl.classList.add('hidden');
            toEl.classList.remove('hidden');
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // Asegurarse de que el contenedor personalizado est√© oculto al inicio
            document.getElementById('custom-words-container').classList.add('hidden');
            
            // Mostrar instrucciones iniciales
            console.log("Bienvenido al Juego del Impostor Pro");
        });
    </script>
</body>
</html>